webpackJsonp([0],{247:function(e,t,s){s(794);var a=s(33)(s(770),s(848),null,null);a.options.__file="D:\\web-proj\\laravel_cms\\resources\\assets\\admin\\src\\views\\own-space\\own-space.vue",a.esModule&&Object.keys(a.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] own-space.vue: functional components are not supported with templates, they should use render functions."),e.exports=a.exports},770:function(e,t,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=s(57),r=a(o),n=s(42),i=a(n);t.default={data:function(){var e=this;return{userForm:{name:"",cellphone:"",job:"",gradeName:""},uid:"",phoneHasChanged:!1,save_loading:!1,identifyError:"",editPasswordModal:!1,savePassLoading:!1,oldPassError:"",identifyCodeRight:!1,hasGetIdentifyCode:!1,checkIdentifyCodeLoading:!1,inforValidate:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],cellphone:[{required:!0,message:"请输入手机号码"},{validator:function(e,t,s){/^1[0-9]{10}$/.test(t)?s():s(new Error("请输入正确格式的手机号"))}}]},editPasswordForm:{oldPass:"",newPass:"",rePass:""},passwordValidate:{oldPass:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],rePass:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:function(t,s,a){s!==e.editPasswordForm.newPass?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}]},initPhone:"",manager:{}}},methods:{getIdentifyCode:function(){var e=this;this.hasGetIdentifyCode=!0,this.$refs.userForm.validate(function(t){if(t){e.canGetIdentifyCode=!0;var s=60,a=setInterval(function(){s>=0?(e.gettingIdentifyCodeBtnContent=s+"秒后重试",s-=1):(clearInterval(a),e.gettingIdentifyCodeBtnContent="获取验证码",e.canGetIdentifyCode=!1)},1e3);e.inputCodeVisible=!0}})},showEditPassword:function(){this.editPasswordModal=!0},cancelEditUserInfor:function(){this.$store.commit("removeTag","ownspace_index"),localStorage.pageOpenedList=(0,r.default)(this.$store.state.pageOpenedList);var e="";e=this.$store.state.pageOpenedList.length>1?this.$store.state.pageOpenedList[1].name:this.$store.state.pageOpenedList[0].name,this.$router.push({name:e})},saveEdit:function(){var e=this;this.$refs.userForm.validate(function(t){t&&e.saveInfoAjax()})},cancelEditPass:function(){this.editPasswordModal=!1},saveEditPass:function(){var e=this;this.$refs.editPasswordForm.validate(function(t){if(t){var s=e.uid;e.savePassLoading=!0,$.ajax({type:"save_pass",dataType:"json",data:{action:"save_info",id:s,old_pass:e.editPasswordForm.oldPass,new_pass:e.editPasswordForm.newPass},url:"http://"+document.location.host+"/manage/manager"}).done(function(t){1e3===t.status?e.$Message.success("保存成功"):e.$Message.warning(t.msg),e.savePassLoading=!1}).fail(function(t){e.$router.push({name:"error_500"})})}})},cancelInputCodeBox:function(){this.inputCodeVisible=!1,this.userForm.cellphone=this.initPhone},submitCode:function(){var e=this;this.checkIdentifyCodeLoading=!0,0===this.securityCode.length?this.$Message.error("请填写短信验证码"):setTimeout(function(){e.$Message.success("验证码正确"),e.inputCodeVisible=!1,e.checkIdentifyCodeLoading=!1},1e3)},hasChangePhone:function(){this.phoneHasChanged=!0,this.hasGetIdentifyCode=!1,this.identifyCodeRight=!1},saveInfoAjax:function(){var e=this;this.save_loading=!0;var t=this.uid;$.ajax({type:"save_info",dataType:"json",data:{action:"save_info",id:t,username:this.userForm.name,telphone:this.userForm.cellphone,avatar:this.manager.avatar},url:"http://"+document.location.host+"/manage/manager"}).done(function(t){1e3===t.status?e.$Message.success("保存成功"):e.$Message.warning(t.msg),e.save_loading=!1}).fail(function(t){e.$router.push({name:"error_500"})})},getInfo:function(){var e=this,t=i.default.get("uid");$.ajax({type:"get",dataType:"json",data:{action:"get_info",id:t},url:"http://"+document.location.host+"/manage/manager"}).done(function(t){if(1e3===t.status){var s=t.info;e.manager=t.info,e.uid=s.id,e.userForm.name=s.username,e.userForm.cellphone=s.telphone,e.initPhone=s.telphone,e.userForm.job=s.job,e.userForm.gradeName=s.grade>0?"管理员":"超级管理员"}else $Msg.warning(t.msg)}).fail(function(t){e.$router.push({name:"error_500"})})},uploadSuccess:function(e,t,s){0===e.errno?this.manager.avatar=e.data[0]:$Msg.error(e.msg)}},beforeMount:function(){getInfo()},computed:{headers:function(){return{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}}}},794:function(e,t){},848:function(e,t,s){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Card",[s("p",{attrs:{slot:"title"},slot:"title"},[s("Icon",{attrs:{type:"person"}}),e._v("\n            个人信息\n        ")],1),e._v(" "),s("div",[s("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":100,"label-position":"right",rules:e.inforValidate}},[s("FormItem",{attrs:{label:"用户姓名：",prop:"name"}},[s("div",{staticStyle:{display:"inline-block",width:"300px"}},[s("Input",{model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1)]),e._v(" "),s("FormItem",{attrs:{label:"用户手机：",prop:"cellphone"}},[s("div",{staticStyle:{display:"inline-block",width:"204px"}},[s("Input",{model:{value:e.userForm.cellphone,callback:function(t){e.$set(e.userForm,"cellphone",t)},expression:"userForm.cellphone"}})],1)]),e._v(" "),s("FormItem",{attrs:{label:"头像"}},[s("Upload",{attrs:{action:"/manage/upload",name:"upload",headers:e.headers,"on-success":e.uploadSuccess,format:["jpg","jpeg","png"],"max-size":2048}},[s("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[e._v("上传图片")])],1),e._v(" "),1===e.manager.hasAvatar?s("div",{staticClass:"demo-upload-list"},[s("img",{staticStyle:{"vertical-align":"top",height:"100px"},attrs:{src:e.manager.avatar}}),e._v(" "),s("div",{staticClass:"demo-upload-list-cover"})]):e._e()],1),e._v(" "),s("FormItem",{attrs:{label:"岗位："}},[s("span",[e._v(e._s(e.userForm.job))])]),e._v(" "),s("FormItem",{attrs:{label:"系统角色："}},[s("span",[e._v(e._s(e.userForm.gradeName))])]),e._v(" "),s("FormItem",{attrs:{label:"登录密码："}},[s("Button",{attrs:{type:"text",size:"small"},on:{click:e.showEditPassword}},[e._v("修改密码")])],1),e._v(" "),s("div",[s("Button",{staticStyle:{width:"100px"},attrs:{type:"text"},on:{click:e.cancelEditUserInfor}},[e._v("取消")]),e._v(" "),s("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.save_loading},on:{click:e.saveEdit}},[e._v("保存")])],1)],1)],1)]),e._v(" "),s("Modal",{attrs:{closable:!1,"mask-closable":!1,width:500},model:{value:e.editPasswordModal,callback:function(t){e.editPasswordModal=t},expression:"editPasswordModal"}},[s("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("修改密码")]),e._v(" "),s("Form",{ref:"editPasswordForm",attrs:{model:e.editPasswordForm,"label-width":100,"label-position":"right",rules:e.passwordValidate}},[s("FormItem",{attrs:{label:"原密码",prop:"oldPass",error:e.oldPassError}},[s("Input",{attrs:{placeholder:"请输入现在使用的密码"},model:{value:e.editPasswordForm.oldPass,callback:function(t){e.$set(e.editPasswordForm,"oldPass",t)},expression:"editPasswordForm.oldPass"}})],1),e._v(" "),s("FormItem",{attrs:{label:"新密码",prop:"newPass"}},[s("Input",{attrs:{placeholder:"请输入新密码，至少6位字符"},model:{value:e.editPasswordForm.newPass,callback:function(t){e.$set(e.editPasswordForm,"newPass",t)},expression:"editPasswordForm.newPass"}})],1),e._v(" "),s("FormItem",{attrs:{label:"确认新密码",prop:"rePass"}},[s("Input",{attrs:{placeholder:"请再次输入新密码"},model:{value:e.editPasswordForm.rePass,callback:function(t){e.$set(e.editPasswordForm,"rePass",t)},expression:"editPasswordForm.rePass"}})],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:e.cancelEditPass}},[e._v("取消")]),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.savePassLoading},on:{click:e.saveEditPass}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});